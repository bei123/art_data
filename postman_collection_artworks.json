{
  "info": {
    "name": "艺术品接口测试集合",
    "description": "艺术品管理系统的完整API测试集合，包含CRUD操作、分页、缓存等测试",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "artworkId",
      "value": "",
      "type": "string"
    },
    {
      "key": "artistId",
      "value": "",
      "type": "string"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "用户认证",
      "item": [
        {
          "name": "用户登录获取Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.token) {",
                  "        pm.collectionVariables.set('token', response.token);",
                  "        console.log('Token已保存:', response.token);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "获取艺术品列表",
      "item": [
        {
          "name": "获取所有艺术品列表 - 默认分页",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应应该是数组', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "});",
                  "",
                  "pm.test('每个艺术品应该包含必要字段', function () {",
                  "    const response = pm.response.json();",
                  "    if (response.length > 0) {",
                  "        const artwork = response[0];",
                  "        pm.expect(artwork).to.have.property('id');",
                  "        pm.expect(artwork).to.have.property('title');",
                  "        pm.expect(artwork).to.have.property('artist');",
                  "        pm.expect(artwork.artist).to.have.property('id');",
                  "        pm.expect(artwork.artist).to.have.property('name');",
                  "    }",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "获取艺术品列表 - 指定分页参数",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks?page=1&pageSize=10",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "pageSize",
                  "value": "10"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('返回数量应该不超过pageSize', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.length).to.be.at.most(10);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "按艺术家ID筛选艺术品",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks?artist_id=1",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"],
              "query": [
                {
                  "key": "artist_id",
                  "value": "1"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('所有艺术品应该属于指定艺术家', function () {",
                  "    const response = pm.response.json();",
                  "    response.forEach(artwork => {",
                  "        pm.expect(artwork.artist.id).to.equal(1);",
                  "    });",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "无效的艺术家ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks?artist_id=-1",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"],
              "query": [
                {
                  "key": "artist_id",
                  "value": "-1"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('错误信息应该正确', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.include('无效的艺术家ID');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "无效的分页参数",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks?page=0&pageSize=-5",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "pageSize",
                  "value": "-5"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200（使用默认值）', function () {",
                  "    pm.response.to.have.status(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "获取艺术品详情",
      "item": [
        {
          "name": "获取艺术品详情 - 成功",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/1",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "1"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应应该包含完整信息', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('title');",
                  "    pm.expect(response).to.have.property('artist');",
                  "    pm.expect(response).to.have.property('collection');",
                  "    pm.expect(response).to.have.property('images');",
                  "    pm.expect(response.images).to.be.an('array');",
                  "});",
                  "",
                  "// 保存艺术品ID用于后续测试",
                  "const response = pm.response.json();",
                  "if (response.id) {",
                  "    pm.collectionVariables.set('artworkId', response.id.toString());",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "获取艺术品详情 - 不存在",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/99999",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "99999"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是404', function () {",
                  "    pm.response.to.have.status(404);",
                  "});",
                  "",
                  "pm.test('错误信息应该正确', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.include('作品不存在');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "获取艺术品详情 - 无效ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/abc",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "abc"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('错误信息应该正确', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.include('无效的作品ID');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "创建艺术品",
      "item": [
        {
          "name": "创建艺术品 - 成功（使用artist_id）",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"测试艺术品\",\n  \"image\": \"https://wx.oss.2000gallery.art/uploads/test.jpg\",\n  \"images\": [\n    \"https://wx.oss.2000gallery.art/uploads/test1.jpg\",\n    \"https://wx.oss.2000gallery.art/uploads/test2.jpg\"\n  ],\n  \"artist_id\": 1,\n  \"year\": 2024,\n  \"description\": \"这是一个测试艺术品\",\n  \"long_description\": \"这是一个详细的测试艺术品描述\",\n  \"background\": \"创作背景\",\n  \"features\": \"艺术特色\",\n  \"collection_location\": \"收藏地点\",\n  \"collection_number\": \"CN001\",\n  \"collection_size\": \"100x100cm\",\n  \"collection_material\": \"油画\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应应该包含创建的艺术品信息', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response).to.have.property('title');",
                  "    pm.expect(response.title).to.equal('测试艺术品');",
                  "    pm.expect(response).to.have.property('artist');",
                  "    pm.expect(response.artist).to.have.property('id');",
                  "    pm.expect(response.artist).to.have.property('name');",
                  "    pm.expect(response).to.have.property('images');",
                  "    pm.expect(response.images).to.be.an('array');",
                  "    pm.expect(response.images).to.have.length(2);",
                  "});",
                  "",
                  "// 保存新创建的艺术品ID",
                  "const response = pm.response.json();",
                  "if (response.id) {",
                  "    pm.collectionVariables.set('artworkId', response.id.toString());",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "创建艺术品 - 使用artist_name",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"使用艺术家名称创建的艺术品\",\n  \"image\": \"https://wx.oss.2000gallery.art/uploads/test3.jpg\",\n  \"images\": [\n    \"https://wx.oss.2000gallery.art/uploads/test4.jpg\"\n  ],\n  \"artist_name\": \"测试艺术家\",\n  \"year\": 2024,\n  \"description\": \"使用艺术家名称创建的艺术品\",\n  \"long_description\": \"详细描述\",\n  \"background\": \"背景\",\n  \"features\": \"特色\",\n  \"collection_location\": \"收藏地\",\n  \"collection_number\": \"CN002\",\n  \"collection_size\": \"80x60cm\",\n  \"collection_material\": \"水彩\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('应该成功创建艺术品', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response.title).to.equal('使用艺术家名称创建的艺术品');",
                  "    pm.expect(response.artist.name).to.equal('测试艺术家');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "创建艺术品 - 缺少必要参数",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"缺少必要参数的艺术品\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('错误信息应该正确', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.include('缺少有效的艺术家ID');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "创建艺术品 - 无效图片URL",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"无效图片URL的艺术品\",\n  \"image\": \"https://invalid-domain.com/image.jpg\",\n  \"artist_id\": 1,\n  \"year\": 2024,\n  \"description\": \"测试\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是400', function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test('错误信息应该正确', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.include('无效的图片URL');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "更新艺术品",
      "item": [
        {
          "name": "更新艺术品 - 成功",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"更新后的艺术品标题\",\n  \"image\": \"https://wx.oss.2000gallery.art/uploads/updated.jpg\",\n  \"images\": [\n    \"https://wx.oss.2000gallery.art/uploads/updated1.jpg\",\n    \"https://wx.oss.2000gallery.art/uploads/updated2.jpg\"\n  ],\n  \"artist_id\": 1,\n  \"year\": 2024,\n  \"description\": \"更新后的描述\",\n  \"long_description\": \"更新后的详细描述\",\n  \"background\": \"更新后的背景\",\n  \"features\": \"更新后的特色\",\n  \"collection_location\": \"更新后的收藏地点\",\n  \"collection_number\": \"CN003\",\n  \"collection_size\": \"120x80cm\",\n  \"collection_material\": \"丙烯\",\n  \"original_price\": 10000,\n  \"discount_price\": 8000,\n  \"stock\": 5,\n  \"sales\": 2,\n  \"is_on_sale\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks/{{artworkId}}",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "{{artworkId}}"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应应该包含更新后的信息', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response.title).to.equal('更新后的艺术品标题');",
                  "    pm.expect(response).to.have.property('original_price');",
                  "    pm.expect(response).to.have.property('discount_price');",
                  "    pm.expect(response).to.have.property('stock');",
                  "    pm.expect(response).to.have.property('sales');",
                  "    pm.expect(response).to.have.property('is_on_sale');",
                  "    pm.expect(response.original_price).to.equal(10000);",
                  "    pm.expect(response.discount_price).to.equal(8000);",
                  "    pm.expect(response.stock).to.equal(5);",
                  "    pm.expect(response.sales).to.equal(2);",
                  "    pm.expect(response.is_on_sale).to.be.true;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "更新艺术品 - 不存在",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"更新不存在的艺术品\",\n  \"artist_id\": 1,\n  \"year\": 2024,\n  \"description\": \"测试\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/artworks/99999",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "99999"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('应该返回错误状态码', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([404, 500]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "删除艺术品",
      "item": [
        {
          "name": "删除艺术品 - 成功",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/{{artworkId}}",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "{{artworkId}}"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应应该包含成功消息', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('message');",
                  "    pm.expect(response.message).to.equal('删除成功');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "删除艺术品 - 不存在",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/99999",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "99999"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('应该返回错误状态码', function () {",
                  "    pm.expect(pm.response.code).to.be.oneOf([404, 500]);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "缓存测试",
      "item": [
        {
          "name": "测试列表缓存",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应时间应该合理', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "测试详情缓存",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks/1",
              "host": ["{{baseUrl}}"],
              "path": ["artworks", "1"]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应时间应该合理', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "性能测试",
      "item": [
        {
          "name": "并发获取列表",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/artworks?page=1&pageSize=50",
              "host": ["{{baseUrl}}"],
              "path": ["artworks"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "pageSize",
                  "value": "50"
                }
              ]
            }
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('状态码应该是200', function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test('响应时间应该合理', function () {",
                  "    pm.expect(pm.response.responseTime).to.be.below(2000);",
                  "});",
                  "",
                  "pm.test('响应大小应该合理', function () {",
                  "    pm.expect(pm.response.size().body).to.be.below(100000);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    }
  ]
} 